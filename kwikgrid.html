<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.css' rel='stylesheet' />
  <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>

  <style>
    #map {
      position: abosolute;
      top: 0;
      bottom: 0;
      height: 100vh;
      width: 100%;
    }
  </style>

</head>


<body>

  <div id="map"></div>

  <script>

    mapboxgl.accessToken = 'pk.eyJ1IjoiYnBhY2h1Y2EiLCJhIjoiY2lxbGNwaXdmMDAweGZxbmg5OGx2YWo5aSJ9.zda7KLJF3TH84UU6OhW16w';
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/satellite-v9',
      center: [121.5, 31.2],
      zoom: 8
    });

    const bbox = [120.7, 30.5, 122.2, 32];
    const cellSide = 1.28;
    const options = {units: 'kilometres'};
    const hexGrid = turf.hexGrid(bbox, cellSide, options);
    hexGrid.features.forEach(f => {
      f.properties = { density: Math.random() };
    });

    map.on('load', function () {

      map.addLayer({
        'id': 'maine',
        'type': 'fill',
        'source': {
          'type': 'geojson',
          'data': hexGrid
        },
        'layout': {},
        'paint': {
          'fill-outline-color': '#fff',
          'fill-color': '#000',
          'fill-opacity': [
            "interpolate", ["linear"], ["get", "density"],
            0, 0.4,
            1, 0.4
          ]
        }
      });
    });

  </script>

</body>

</html>